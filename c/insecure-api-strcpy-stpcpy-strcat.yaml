rules:
  - id: insecure-api-strcpy-stpcpy-strcat
    metadata:
      author: Marco Ivaldi <raptor@0xdeadbeef.info>
      references:
        - https://cwe.mitre.org/data/definitions/676
        - https://cwe.mitre.org/data/definitions/120
        - https://cwe.mitre.org/data/definitions/787
      confidence: MEDIUM
    message: >-
      If the destination string of a strcpy(), stpcpy(), or strcat() is not
      large enough, then program behavior is unpredictable; buffer overruns
      are a favorite avenue for attacking programs. Any time a program
      copies or appends data into a buffer, the program first needs to
      check that there's enough space.
      This may be unnecessary if you can show that overflow is impossible,
      but be careful, as programs can get changed over time, in ways that
      may make the impossible possible.
    severity: WARNING
    languages:
      - c
      - cpp
    pattern-either:
      - pattern: strcpy(...)
      - pattern: stpcpy(...)
      - pattern: strcat(...)
