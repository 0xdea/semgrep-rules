rules:
  - id: raptor-insecure-random-seed
    metadata:
      author: Riccardo Cardelli <gand3lf>
      references:
        - https://cwe.mitre.org/data/definitions/335
        - https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf
      confidence: HIGH
    message: The use of a predictable or a static seed risks making the output
      of  the random functions easily guessable.
    severity: WARNING
    languages:
      - c
      - cpp
    options:
      interfile: true
    mode: taint
    pattern-sources:
      - pattern: time(...)
      - pattern: getpid(...)
      - pattern: timespec_get(...)
      - pattern: gettimeofday(...)
      - pattern: clock_gettime(...)
      - pattern: GetSystemTime(...) #Windows
      - pattern: GetLocalTime(...) # Windows
      - pattern: clock(...)
      - pattern: (int $X)
    pattern-propagators:
      - pattern: <... $F(...,&$P, ...) ...>
        from: $F
        to: $P
    pattern-sinks:
      - pattern: srand(...)
      - pattern: srandom(...)
      - pattern: $R.seed(...)
