rules:
  - id: raptor-missing-default-in-switch
    metadata:
      author: Marco Ivaldi <raptor@0xdeadbeef.info>
      references:
        - https://cwe.mitre.org/data/definitions/478
        - https://g.co/kgs/PCHQjJ
        - https://github.com/struct/mms
        - https://github.com/returntocorp/semgrep/issues/4939
      confidence: MEDIUM
      # NOTE: a rule to check for "CWE-484: Omitted Break Statement in 
      # Switch" (https://cwe.mitre.org/data/definitions/484) would also
      # be appropriate, if/when Semgrep addresses the issue above.
    message: >-
      The code does not have a default case in an expression with multiple
      conditions, such as a switch statement.
    severity: WARNING
    languages:
      - c
      - cpp
    patterns:
      - pattern: |
          switch ($VAR) { }
      - pattern-not: |
          switch ($VAR) { default: ... }
