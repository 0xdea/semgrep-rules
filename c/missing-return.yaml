rules:
  - id: raptor-missing-return
    metadata:
      author: Marco Ivaldi <raptor@0xdeadbeef.info>
      references:
        - https://cwe.mitre.org/data/definitions/393
        - https://cwe.mitre.org/data/definitions/394
      confidence: MEDIUM
    message: >-
      A non-void function does not have a return statement. Hence, its
      return value can be considered undefined.
    severity: WARNING
    languages:
      - c
      - cpp
    patterns:
      - pattern-inside: |
          $TYPE $FUN(...) { ... }
      # exclude function declarations
      - pattern-not-inside: |
          $TYPE $FUN(...);
      # exclude functions with return statement
      - pattern-not-inside: |
          $TYPE $FUN(...) { ... return $RET; }
      # exclude void functions
      - pattern-not-inside: |
          void $FUN(...) { ... }
      # exclude main function
      - pattern-not-inside: |
          int main(...) { ... }
      # exclude else if
      - pattern-not-inside: |
          ... if ($COND) { ... }
