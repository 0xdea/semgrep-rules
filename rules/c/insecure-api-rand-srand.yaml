rules:
  - id: raptor-insecure-api-rand-srand
    metadata:
      author: Marco Ivaldi <raptor@0xdeadbeef.info>
      references:
        - https://cwe.mitre.org/data/definitions/338
        - https://cwe.mitre.org/data/definitions/330
        - https://www.sei.cmu.edu/downloads/sei-cert-c-coding-standard-2016-v01.pdf
      confidence: HIGH
      # NOTE: `rand_r` and other non-standard PRNGs are not covered.
      # NOTE: improperly seeded strong PRNGs are not covered.
      # NOTE: see also `cpp.rng.*`, `cpp.crypto.*`, and `gitlab.flawfinder.*`.
    message: >-
      The rand() PRNG should not be used in applications intended to be 
      portable when good randomness is needed. Instead, the use of random() 
      is recommended.
    severity: WARNING
    languages:
      - c
      - cpp
    pattern-either:
      - pattern: rand(...)
      - pattern: srand(...)
      - pattern: drand48(...)
      - pattern: erand48(...)
      - pattern: lrand48(...)
      - pattern: nrand48(...)
      - pattern: mrand48(...)
      - pattern: jrand48(...)
      - pattern: lcong48(...)
      - pattern: srand48(...)
      - pattern: seed48(...)
